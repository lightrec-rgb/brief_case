<div class="grid md:grid-cols-4 gap-4">
  <!-- Subjects (Blue ‚Üí Cyan gradient) -->
  <div class="rounded-2xl p-4 text-white shadow-sm bg-gradient-to-br from-brand-blue via-blue-700 to-cyan-600">
    <div class="flex items-start justify-between">
      <div>
        <div class="text-sm opacity-90">Subjects</div>
        <div class="text-3xl font-semibold mt-1"><%= @subjects_count %></div>
      </div>
      <div class="opacity-90" aria-hidden="true">üìö</div>
    </div>
    <div class="mt-3">
      <%= link_to "Manage subjects",
          subjects_path,
          class: "inline-block text-sm px-3 py-1.5 rounded-full bg-white/20 hover:bg-white/30 focus:outline-none focus:ring-2 focus:ring-white/60" %>
    </div>
  </div>

  <!-- Cases (Enhanced Gold ‚Üí Orange gradient, dark text) -->
  <div class="rounded-2xl p-4 text-slate-900 shadow-sm bg-gradient-to-br from-amber-300 via-yellow-400 to-orange-400 border border-amber-200/60">
    <div class="flex items-start justify-between">
      <div>
        <div class="text-sm opacity-80">Cases</div>
        <div class="text-3xl font-semibold mt-1"><%= @cases_count %></div>
      </div>
      <div class="opacity-80" aria-hidden="true">‚öñÔ∏è</div>
    </div>
    <div class="mt-3">
      <%= link_to "Add Case",
          new_entry_path(kind: "Case", subject_id: @only_subject_id),
          class: "inline-block text-sm px-3 py-1.5 rounded-full bg-white/70 hover:bg-white focus:outline-none focus:ring-2 focus:ring-amber-300" %>
    </div>
  </div>

  <!-- Acts & Provisions (Purple ‚Üí Indigo gradient) -->
  <div class="rounded-2xl p-4 text-white shadow-sm bg-gradient-to-br from-purple-500 via-indigo-600 to-indigo-800">
    <div class="flex items-start justify-between">
      <div>
        <div class="text-sm opacity-90">Acts &amp; Provisions</div>
        <div class="text-3xl font-semibold mt-1">
          <span class="align-middle"><%= @acts_count %></span>
          <span class="text-base font-normal opacity-90 align-middle">Acts</span>
          <span class="mx-1 opacity-75">¬∑</span>
          <span class="align-middle"><%= @provisions_count %></span>
          <span class="text-base font-normal opacity-90 align-middle">Provisions</span>
        </div>
      </div>
      <div class="opacity-90" aria-hidden="true">üìú</div>
    </div>
    <div class="mt-3">
      <%= link_to "Add Act",
          new_act_path(subject_id: @only_subject_id),
          class: "inline-block text-sm px-3 py-1.5 rounded-full bg-white/20 hover:bg-white/30 focus:outline-none focus:ring-2 focus:ring-white/60" %>
    </div>
  </div>

  <!-- View cards -->
  <div class="rounded-2xl p-4 text-slate-900 shadow-sm bg-gradient-to-br from-slate-50 to-slate-200 border border-slate-200/80">
    <div class="flex items-start justify-between">
      <div>
        <div class="text-sm text-slate-700">View cards</div>
        <div class="text-3xl font-semibold mt-1"><%= @entries_count %></div>
      </div>
      <div class="text-slate-700" aria-hidden="true">üóÇÔ∏è</div>
    </div>
    <div class="mt-3">
      <%= link_to "View cards",
          entries_path(**(@only_subject_id ? { subject_id: @only_subject_id } : {})),
          class: "inline-block text-sm px-3 py-1.5 rounded-full bg-white/70 hover:bg-white focus:outline-none focus:ring-2 focus:ring-slate-300" %>
    </div>
  </div>
</div>

<%# ===================== RECENT SESSIONS ===================== %>
<div class="mt-8 w-full">
  <div class="flex items-center justify-between mb-3">
    <h2 class="text-xl font-semibold">Recent sessions</h2>
    <%= link_to "Create new session",
          new_session_path,
          class: "bg-brand-blue text-white px-3 py-2 rounded hover:bg-gold text-sm font-medium" %>
  </div>

  <% recent = current_user.sessions.where.not(status: :completed).order(updated_at: :desc).limit(10) %>

  <% if recent.blank? %>
    <p class="text-gray-600">No sessions yet.</p>
  <% else %>
    <div class="overflow-x-auto">
      <table class="w-full text-sm">
        <thead>
          <tr class="text-left border-b">
            <th class="py-2 pr-2">Name</th>
            <th class="py-2 pr-2">Subject</th>
            <th class="py-2 px-2 text-center">Total</th>
            <th class="py-2 px-2 text-center">New</th>
            <th class="py-2 px-2 text-center">Due</th>
            <th class="py-2 pr-2">Status</th>
            <th class="py-2 px-2 text-center">Actions</th>
          </tr>
        </thead>
        <tbody>
          <% recent.each do |s| %>
            <% total     = s.total_count.to_i %>
            <% new_cards = s.new_count.to_i %>
            <% due_now   = s.due_count.to_i %>

            <tr class="border-b">
              <td class="py-2 pr-2"><%= s.name.presence || "Session ##{s.id}" %></td>

              <td class="py-2 pr-2 text-gray-700">
                <%= s.subject ? s.subject.path.map(&:name).join(" ‚Ä∫ ") : "(No subject)" %>
              </td>

              <td class="py-2 px-2 text-center whitespace-nowrap">
                <span class="inline-flex items-center rounded-full bg-gray-100 px-2 py-0.5 text-xs text-gray-700">
                  <strong class="ml-1"><%= total %></strong>
                </span>
              </td>

              <td class="py-2 px-2 text-center whitespace-nowrap">
                <span class="inline-flex items-center rounded-full px-2 py-0.5 text-xs
                            <%= new_cards.positive? ? "bg-[#e6f0ff] text-blue-700 font-bold" : "bg-[#e6f0ff] text-[#0b57d0]" %>">
                  New <strong class="ml-1"><%= new_cards %></strong>
                </span>
              </td>

              <td class="py-2 px-2 text-center whitespace-nowrap">
                <span class="inline-flex items-center rounded-full px-2 py-0.5 text-xs
                            <%= due_now.positive? ? "bg-[#e9f7ef] text-emerald-700 font-bold" : "bg-[#e9f7ef] text-[#1e7e34]" %>">
                  Due <strong class="ml-1"><%= due_now %></strong>
                </span>
              </td>

              <td class="py-2 pr-2"><%= session_status_badge(s) %></td>

              <td class="py-2 px-2 text-center">
                <%= link_to "Open",
                      session_path(s),
                      class: "inline-block bg-brand-blue text-white px-2.5 py-1.5 rounded hover:bg-gold text-xs font-medium" %>
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  <% end %>
</div>
